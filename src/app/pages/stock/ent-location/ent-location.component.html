<div class="row text-center mt-2">
  <div class="col-12">
    <div *ngIf="this.inputMethod == 'textBus'" class="text-center"><strong>{{textBus}}</strong></div>
    <form [formGroup]="searchForm" *ngIf="this.inputMethod == 'form'">
      <div class="input-group input-group-lg">
        <input type="text" autofocus #search class="form-control" id="bus" formControlName="search" aria-label="Large" aria-describedby="inputGroup-sizing-sm">
        <span class="input-group-append">
          <button class="btn btn-primary btn-lg" (click)="formSearch()" type="button">
            <i class="fa fa-search"></i>
          </button>
        </span>
      </div>
    </form>
    <ul class="list-group">
      <li *ngFor="let item of moves;let i = index;" class="text-left list-group-item">
        <div class="row">
          <div class="text-center col-2 pt-0 pb-0 pl-0 pr-0">
            <div class="text-bold  bg-danger text-white text-white">{{ item['quantity_done']}}<br />
              <small class="text-bold">Scan</small>
            </div>
            <div>{{ item['reserved_availability'] }}
              <small class="">Res</small>
            </div>
          </div>
          <div class="col-8">
            <div>{{ item['product_id'][1] }}</div>
            <small> remito: {{ item['picking_id'][1]}}</small>
          </div>
          <div class="col-2">
            <button type="button" (click)="active_index=i;addQty=1;" data-toggle="modal" data-target="#moveLineModal"  [ngClass]="{'btn': true}"><i class="fa fa-list"></i></button>
          </div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="text-center spinnerContent">
  <div class="spinner-grow text-warning" *ngIf="spinner" style="width: 5rem; height: 5rem;" role="status">
    <span class="sr-only">Loading...</span>
  </div>
</div>

<div class="row text-center ">
  <div class="btn-group btn-group-lg fixed-bottom" role="group">
    <button type="button" (click)="inputMethod = 'form'" [ngClass]="{'btn': true, 'btn-info': true, 'active': inputMethod == 'form'}"><i class="fa fa-font"></i></button>
    <button type="button" (click)="inputMethod = 'textBus'" [ngClass]="{'btn': true, 'btn-info': true, 'active': inputMethod == 'textBus'}"><i class="fa fa-barcode"></i></button>
  </div>
</div>

<div  #theModal class="modal fade" id="moveLineModal" tabindex="-1" role="dialog" aria-labelledby="moveLineModalLabel" aria-hidden="true">
  <div *ngIf="active_index !== undefined" class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">{{ moves[active_index]['product_id'][1]}}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" >

        <h2 class="bg-danger text-center text-white mb-0"> {{ moves[active_index]['scanned_qty'] }}</h2>
        <div class="bg-dark text-center  text-white mt-0">Escaneados</div>

        <div *ngIf="moves[active_index]['picking_id']">Remito: <strong>{{ moves[active_index]['picking_id'][1]}}</strong></div>
      	<div>Realizados: <strong>{{ moves[active_index]['quantity_done'] }}</strong></div>
        <div>Reservados: <strong>{{ moves[active_index]['reserved_availability'] }}</strong></div>
        <div>Total: <strong>{{ moves[active_index]['product_uom_qty'] }}</strong></div>

        <div *ngIf="moves[active_index]['barcode']">Codigo de barra: <strong>{{ moves[active_index]['barcode'] }}</strong></div>
        <div>Codigo interno: <strong>{{ moves[active_index]['default_code'] }}</strong></div>
        <div *ngIf="moves[active_index]['modelo_articulo']">Modelo: <strong>{{ moves[active_index]['modelo_articulo'] }}</strong></div>
        <div class="btn-group  w-100" role="group">
          <button type="button" (click)="addQty=1" [ngClass]="{'btn': true, 'btn-dark': true, 'active': addQty==1}">1</button>
          <button type="button" (click)="addQty=5" [ngClass]="{'btn': true, 'btn-dark': true, 'active': addQty==5}">5</button>
          <button type="button" (click)="addQty=10" [ngClass]="{'btn': true, 'btn-dark': true, 'active': addQty==10}">10 </button>
          <button type="button" (click)="addQty=20" [ngClass]="{'btn': true, 'btn-dark': true, 'active': addQty==2}">20 </button>
          <button type="button" (click)="addQty=50" [ngClass]="{'btn': true, 'btn-dark': true, 'active': addQty==50}">50 </button>
          <button type="button" (click)="addQty=100" [ngClass]="{'btn': true, 'btn-dark': true, 'active': addQty==100}">100 </button>
        </div>
        <div class="btn-group btn-group-lg w-100" role="group">
          <button type="button" (click)="addScannedQuantity(active_index,-1 * addQty)" class="btn btn-danger"><i class="fa fa-minus"></i></button>
          <button type="button" (click)="addScannedQuantity(active_index,addQty)" class="btn btn-danger"><i class="fa fa-plus"></i></button>

        </div>
        <hr/>
          <button  type="button" (click)="parcialMoveProducts(active_index)" class="btn btn-block btn-success btn-lg w-100">Movimiento parcial de productos</button>


      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>